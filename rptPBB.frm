VERSION 5.00
Object = "{C4847593-972C-11D0-9567-00A0C9273C2A}#8.0#0"; "crviewer.dll"
Begin VB.Form rptPBB 
   Caption         =   "Cetak"
   ClientHeight    =   7425
   ClientLeft      =   120
   ClientTop       =   450
   ClientWidth     =   11910
   Icon            =   "rptPBB.frx":0000
   LinkTopic       =   "Form1"
   MDIChild        =   -1  'True
   Picture         =   "rptPBB.frx":1382
   ScaleHeight     =   7425
   ScaleWidth      =   11910
   WindowState     =   2  'Maximized
   Begin CRVIEWERLibCtl.CRViewer CRViewer1 
      Height          =   7005
      Left            =   0
      TabIndex        =   0
      Top             =   -15
      Width           =   5805
      DisplayGroupTree=   0   'False
      DisplayToolbar  =   -1  'True
      EnableGroupTree =   -1  'True
      EnableNavigationControls=   -1  'True
      EnableStopButton=   -1  'True
      EnablePrintButton=   -1  'True
      EnableZoomControl=   -1  'True
      EnableCloseButton=   -1  'True
      EnableProgressControl=   -1  'True
      EnableSearchControl=   -1  'True
      EnableRefreshButton=   -1  'True
      EnableDrillDown =   -1  'True
      EnableAnimationControl=   -1  'True
      EnableSelectExpertButton=   0   'False
      EnableToolbar   =   -1  'True
      DisplayBorder   =   0   'False
      DisplayTabs     =   -1  'True
      DisplayBackgroundEdge=   -1  'True
      SelectionFormula=   ""
      EnablePopupMenu =   -1  'True
      EnableExportButton=   -1  'True
      EnableSearchExpertButton=   0   'False
      EnableHelpButton=   -1  'True
   End
End
Attribute VB_Name = "rptPBB"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim Report As New rSPPT
Dim rSim As New rSimulasi
'Dim rSTTS As New rSTTS
Dim xNama, xNIP, xJabatan
'Dim rSEM




Private Sub CRViewer1_CloseButtonClicked(UseDefault As Boolean)

End Sub

Private Sub Form_Activate()
On Error GoTo Salah
Screen.MousePointer = vbHourglass
frmUtama.mnSetting.Enabled = True
C_PEJABAT
If J_CETAK = 1 Or J_CETAK = 100 Or J_CETAK = 400 Then
Me.Caption = "Cetak SPPT PBB-P2 Tahun Anggaran " & C_TAHUN

If frmCetak_Massal.hTunggal.Value = 1 Then
    C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        " FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND ([SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP])='" & c_NOP & "' " & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
Else
  If C_KEC = "*.*" And C_KEL = "*.*" Then
        If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        Else
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        End If
        
    ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
        If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        Else
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        End If
    Else
        If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND SPPT.KD_KELURAHAN='" & C_KEL & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        Else
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
        ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND SPPT.KD_KELURAHAN='" & C_KEL & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
        " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
        End If
    End If
End If
openDB (C_STR)

If rPajak.RecordCount > 0 Then rPajak.MoveFirst
If J_CETAK = 1 Then
    rSPPT.Database.SetDataSource rPajak
    rSPPT.tNip.SetText "NIP. " & xNIP
    rSPPT.tNama.SetText xNama
    rSPPT.tkepala.SetText xJabatan
    CRViewer1.ReportSource = rSPPT
    CRViewer1.ViewReport
    rSPPT.DiscardSavedData
ElseIf J_CETAK = 100 Then
    rSPPT1.Database.SetDataSource rPajak
    rSPPT1.tNip.SetText "NIP. " & xNIP
    rSPPT1.tNama.SetText xNama
    rSPPT1.tkepala.SetText xJabatan
    CRViewer1.ReportSource = rSPPT1
    CRViewer1.ViewReport
    rSPPT1.DiscardSavedData
ElseIf J_CETAK = 400 Then
    rSPPTt.Database.SetDataSource rPajak
    rSPPTt.tNip.SetText "NIP. " & xNIP
    rSPPTt.tNama.SetText xNama
    rSPPTt.tkepala.SetText xJabatan
    CRViewer1.ReportSource = rSPPTt
    CRViewer1.ViewReport
    rSPPTt.DiscardSavedData
End If

ElseIf J_CETAK = 2 Or J_CETAK = 200 Or J_CETAK = 500 Then
        Me.Caption = "Cetak SSPD PBB-P2 Tahun Anggaran " & C_TAHUN
    
    If frmCetak_Massal.hTunggal.Value = 1 Then
        C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            " FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND ([SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP])='" & c_NOP & "' " & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
    Else
      If C_KEC = "*.*" And C_KEL = "*.*" Then
            If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            Else
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            End If
        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
            If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            Else
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            End If
        Else
            If frmCetak_Massal.cRekam.Visible = True And frmCetak_Massal.cRekam.Value = 1 Then
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND SPPT.KD_KELURAHAN='" & C_KEL & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) AND (QOBJEKPAJAK.TGL_PEREKAMAN_OP > ='" & Format(frmCetak_Massal.dRekam1.Value, "YYYY/MM/DD") & "' AND QOBJEKPAJAK.TGL_PEREKAMAN_OP <='" & Format(frmCetak_Massal.dRekam2.Value, "YYYY/MM/DD") & "')" & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            Else
            C_STR = "SELECT REF_MAP.KD_MAP, REF_JNS_SEKTOR.NM_SEKTOR, [SPPT].[KD_PROPINSI]+'.'+[SPPT].[KD_DATI2]+'.'+[SPPT].[KD_KECAMATAN]+'.'+[SPPT].[KD_KELURAHAN]+'.'+[SPPT].[KD_BLOK]+'-'+[SPPT].[NO_URUT]+'.'+[SPPT].[KD_JNS_OP] AS NOPQ, SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.THN_PAJAK_SPPT, SPPT.NM_WP_SPPT, SPPT.JLN_WP_SPPT, SPPT.BLOK_KAV_NO_WP_SPPT, SPPT.RW_WP_SPPT, SPPT.RT_WP_SPPT, SPPT.KELURAHAN_WP_SPPT, SPPT.KOTA_WP_SPPT, SPPT.KD_POS_WP_SPPT, SPPT.NPWP_SPPT, SPPT.NO_PERSIL_SPPT, SPPT.KD_KLS_TANAH, SPPT.KD_KLS_BNG, SPPT.LUAS_BUMI_SPPT, SPPT.LUAS_BNG_SPPT, SPPT.NJOP_BUMI_SPPT, SPPT.NJOP_BNG_SPPT, SPPT.NJOP_SPPT, SPPT.NJOPTKP_SPPT, SPPT.NJKP_SPPT, SPPT.PBB_TERHUTANG_SPPT, SPPT.FAKTOR_PENGURANG_SPPT, SPPT.PBB_YG_HARUS_DIBAYAR_SPPT, SPPT.TGL_JATUH_TEMPO_SPPT, SPPT.TGL_TERBIT_SPPT, SPPT.TGL_CETAK_SPPT, TEMPAT_BAYAR.NM_TP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.BLOK_KAV_NO_OP, QOBJEKPAJAK.RW_OP, QOBJEKPAJAK.RT_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN" & _
            ",QOBJEKPAJAK.TGL_PEREKAMAN_OP  FROM QOBJEKPAJAK INNER JOIN (((SPPT INNER JOIN REF_KELURAHAN ON (SPPT.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (SPPT.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN (REF_JNS_SEKTOR INNER JOIN REF_MAP ON REF_JNS_SEKTOR.KD_SEKTOR = REF_MAP.KD_SEKTOR) ON REF_KELURAHAN.KD_SEKTOR = REF_MAP.KD_SEKTOR) INNER JOIN TEMPAT_BAYAR ON SPPT.KD_TP = TEMPAT_BAYAR.KD_TP) ON (QOBJEKPAJAK.KD_JNS_OP = SPPT.KD_JNS_OP) AND (QOBJEKPAJAK.NO_URUT = SPPT.NO_URUT) AND (QOBJEKPAJAK.KD_BLOK = SPPT.KD_BLOK) AND (QOBJEKPAJAK.KD_KELURAHAN = SPPT.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_Kecamatan = SPPT.KD_KECAMATAN) WHERE SPPT.KD_KECAMATAN='" & C_KEC & "' AND SPPT.KD_KELURAHAN='" & C_KEL & "' AND (((SPPT.THN_PAJAK_SPPT)='" & C_TAHUN & "')) " & _
            " ORDER BY SPPT.KD_KECAMATAN, SPPT.KD_KELURAHAN, SPPT.KD_BLOK, SPPT.NO_URUT, SPPT.KD_JNS_OP"
            End If
        End If
    End If
    openDB (C_STR)
    
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    If J_CETAK = 2 Then
        rSTTS.Database.SetDataSource rPajak
        'rSPPT.tNIP.SetText xNIP
        'rSPPT.tNama.SetText xNama
        'rSPPT.tkepala.SetText xJabatan
        CRViewer1.ReportSource = rSTTS
        CRViewer1.ViewReport
        rSTTS.DiscardSavedData
    ElseIf J_CETAK = 200 Then
        rSSPD.Database.SetDataSource rPajak
        CRViewer1.ReportSource = rSSPD
        CRViewer1.ViewReport
        rSSPD.DiscardSavedData
    ElseIf J_CETAK = 500 Then
        rSSPDt.Database.SetDataSource rPajak
        CRViewer1.ReportSource = rSSPDt
        CRViewer1.ViewReport
        rSSPDt.DiscardSavedData
    End If
'    rSTTS.PrinterSetup Me.hWnd
 '   CRViewer1.Refresh
ElseIf J_CETAK = 3 Or J_CETAK = 300 Then
        Me.Caption = "Cetak Daftar Himpunan Ketetapan Pajak dan Pembayaran Tahun " & C_TAHUN
    
    C_STR = "SELECT * FROM TEMP_DHKP ORDER BY THN_PAJAK,KD_KECAMATAN,KD_KELURAHAN,NOPQ ASC"
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    
    If J_CETAK = 3 Then
        rDHKP.Database.SetDataSource rPajak
        rDHKP.tNip.SetText "NIP. " & xNIP
        rDHKP.tNama.SetText xNama
        rDHKP.tkepala.SetText xJabatan
        rDHKP.tNIP1.SetText "NIP. " & xNIP
        rDHKP.tNama1.SetText xNama
        rDHKP.tKepala1.SetText xJabatan
        rDHKP.tJudul.SetText "TAHUN " & C_TAHUN
        'rDHKP.tJudul2.SetText C_TAHUN
        CRViewer1.ReportSource = rDHKP
        CRViewer1.ViewReport
        rDHKP.DiscardSavedData
    ElseIf J_CETAK = 300 Then
        rDHKP1.Database.SetDataSource rPajak
        rDHKP1.tNip.SetText "NIP. " & xNIP
        rDHKP1.tNama.SetText xNama
        rDHKP1.tkepala.SetText xJabatan
        rDHKP1.tNIP1.SetText "NIP. " & xNIP
        rDHKP1.tNama1.SetText xNama
        rDHKP1.tKepala1.SetText xJabatan
        rDHKP1.tJudul.SetText "TAHUN " & C_TAHUN
        'rDHKP.tJudul2.SetText C_TAHUN
        CRViewer1.ReportSource = rDHKP1
        CRViewer1.ViewReport
        rDHKP1.DiscardSavedData
    End If
ElseIf J_CETAK = 4 Then
    Me.Caption = "Cetak Klasifikasi dan Besaran NJOP Bumi Tahun " & C_TAHUN
    C_STR = "SELECT * FROM TEMP_BUMI ORDER BY BLOK, NM_JALAN ASC"
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rKelas1.Database.SetDataSource rPajak
    rKelas1.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    rKelas1.tNip.SetText "NIP. " & xNIP
    rKelas1.tNama.SetText xNama
    rKelas1.tJab.SetText xJabatan
    rKelas1.tJudul.SetText "TAHUN " & C_TAHUN
    'rDHKP.tJudul2.SetText C_TAHUN
    CRViewer1.ReportSource = rKelas1
    CRViewer1.ViewReport
    rKelas1.DiscardSavedData
ElseIf J_CETAK = 5 Then
Me.Caption = "Cetak Simulasi Perbandingan PBB Tahun " & C_TAHUN * 1 & " dengan Tahun " & C_TAHUN * 1 - 1

    C_STR = "SELECT * FROM SPPT_SIMULASI1 ORDER BY THN_PAJAK*1 DESC"
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rSimulasi.tJudul1.SetText "PERBANDINGAN KETETAPAN SPPT TAHUN " & C_TAHUN * 1 - 1 & " DAN SIMULASI KETETAPAN SPPT TAHUN " & C_TAHUN * 1
    rSimulasi.tJudul2.SetText "SPPT TAHUN " & C_TAHUN
    rSimulasi.tJudul3.SetText "SPPT TAHUN " & C_TAHUN * 1 - 1
    rSimulasi.Database.SetDataSource rPajak
    rSimulasi.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    rSimulasi.tNip.SetText "NIP. " & xNIP
    rSimulasi.tNama.SetText xNama
    rSimulasi.tkepala.SetText xJabatan


    CRViewer1.ReportSource = rSimulasi
    CRViewer1.ViewReport
    rSimulasi.DiscardSavedData
ElseIf J_CETAK = 10 Then
        If C_KEC = "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_NILAI_INDIVIDU.NILAI_INDIVIDU*1000, DAT_NILAI_INDIVIDU.TGL_PENILAIAN_INDIVIDU, QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, DAT_OP_BANGUNAN.LUAS_BNG, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ," & _
            "DAT_OP_BANGUNAN.NILAI_SISTEM_BNG*1000, DAT_OP_BANGUNAN.KD_JPB, REF_JPB.NM_JPB FROM ((DAT_NILAI_INDIVIDU INNER JOIN QOBJEKPAJAK ON (DAT_NILAI_INDIVIDU.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan)) INNER JOIN DAT_OP_BANGUNAN ON (DAT_NILAI_INDIVIDU.NO_BNG = DAT_OP_BANGUNAN.NO_BNG) AND (DAT_NILAI_INDIVIDU.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN)) INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB"

        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_NILAI_INDIVIDU.NILAI_INDIVIDU*1000, DAT_NILAI_INDIVIDU.TGL_PENILAIAN_INDIVIDU, QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, DAT_OP_BANGUNAN.LUAS_BNG, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ," & _
            "DAT_OP_BANGUNAN.NILAI_SISTEM_BNG*1000, DAT_OP_BANGUNAN.KD_JPB, REF_JPB.NM_JPB FROM ((DAT_NILAI_INDIVIDU INNER JOIN QOBJEKPAJAK ON (DAT_NILAI_INDIVIDU.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan)) INNER JOIN DAT_OP_BANGUNAN ON (DAT_NILAI_INDIVIDU.NO_BNG = DAT_OP_BANGUNAN.NO_BNG) AND (DAT_NILAI_INDIVIDU.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN)) INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB where DAT_NILAI_INDIVIDU.KD_KECAMATAN='" & C_KEC & "'"
        Else
            C_STR = "SELECT DAT_NILAI_INDIVIDU.NILAI_INDIVIDU*1000, DAT_NILAI_INDIVIDU.TGL_PENILAIAN_INDIVIDU, QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, DAT_OP_BANGUNAN.LUAS_BNG, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ," & _
            "DAT_OP_BANGUNAN.NILAI_SISTEM_BNG*1000, DAT_OP_BANGUNAN.KD_JPB, REF_JPB.NM_JPB FROM ((DAT_NILAI_INDIVIDU INNER JOIN QOBJEKPAJAK ON (DAT_NILAI_INDIVIDU.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan)) INNER JOIN DAT_OP_BANGUNAN ON (DAT_NILAI_INDIVIDU.NO_BNG = DAT_OP_BANGUNAN.NO_BNG) AND (DAT_NILAI_INDIVIDU.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) AND (DAT_NILAI_INDIVIDU.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_NILAI_INDIVIDU.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_NILAI_INDIVIDU.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_NILAI_INDIVIDU.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN)) INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB where DAT_NILAI_INDIVIDU.KD_KECAMATAN='" & C_KEC & "' AND DAT_NILAI_INDIVIDU.KD_KELURAHAN='" & C_KEL & "' "
        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rINDIVIDU.tJudul.SetText "TAHUN " & C_TAHUN
     rINDIVIDU.tNip.SetText "NIP. " & xNIP
    rINDIVIDU.tNama.SetText xNama
    rINDIVIDU.tJab.SetText xJabatan
    rINDIVIDU.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rINDIVIDU.Database.SetDataSource rPajak
    CRViewer1.ReportSource = rINDIVIDU
    CRViewer1.ViewReport
    rINDIVIDU.DiscardSavedData
ElseIf J_CETAK = 20 Then
        If C_KEC = "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_NIR.THN_NIR_ZNT, DAT_NIR.NIR, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.TOTAL_LUAS_BUMI, QOBJEKPAJAK.NJOP_BUMI, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KD_ZNT, QOBJEKPAJAK.NILAI_SISTEM_BUMI, QOBJEKPAJAK.JNS_BUMI FROM QOBJEKPAJAK INNER JOIN DAT_NIR ON (QOBJEKPAJAK.KD_Kecamatan = DAT_NIR.KD_KECAMATAN) AND (QOBJEKPAJAK.KD_KELURAHAN = DAT_NIR.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_ZNT = DAT_NIR.KD_ZNT) WHERE DAT_NIR.THN_NIR_ZNT='" & C_TAHUN & "'"
        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_NIR.THN_NIR_ZNT, DAT_NIR.NIR, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.TOTAL_LUAS_BUMI, QOBJEKPAJAK.NJOP_BUMI, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KD_ZNT, QOBJEKPAJAK.NILAI_SISTEM_BUMI, QOBJEKPAJAK.JNS_BUMI FROM QOBJEKPAJAK INNER JOIN DAT_NIR ON (QOBJEKPAJAK.KD_Kecamatan = DAT_NIR.KD_KECAMATAN) AND (QOBJEKPAJAK.KD_KELURAHAN = DAT_NIR.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_ZNT = DAT_NIR.KD_ZNT) WHERE DAT_NIR.THN_NIR_ZNT='" & C_TAHUN & "' AND QOBJEKPAJAK.KD_KECAMATAN='" & C_KEC & "'"
        Else
            C_STR = "SELECT DAT_NIR.THN_NIR_ZNT, DAT_NIR.NIR, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.TOTAL_LUAS_BUMI, QOBJEKPAJAK.NJOP_BUMI, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KD_ZNT, QOBJEKPAJAK.NILAI_SISTEM_BUMI, QOBJEKPAJAK.JNS_BUMI FROM QOBJEKPAJAK INNER JOIN DAT_NIR ON (QOBJEKPAJAK.KD_Kecamatan = DAT_NIR.KD_KECAMATAN) AND (QOBJEKPAJAK.KD_KELURAHAN = DAT_NIR.KD_KELURAHAN) AND (QOBJEKPAJAK.KD_ZNT = DAT_NIR.KD_ZNT) WHERE DAT_NIR.THN_NIR_ZNT='" & C_TAHUN & "' AND QOBJEKPAJAK.KD_KECAMATAN='" & C_KEC & "' AND QOBJEKPAJAK.KD_KELURAHAN='" & C_KEL & "'"
        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rDetail2.tJudul.SetText "TAHUN " & C_TAHUN
     rDetail2.tNip.SetText "NIP. " & xNIP
    rDetail2.tNama.SetText xNama
    rDetail2.tJab.SetText xJabatan
    rDetail2.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rDetail2.Database.SetDataSource rPajak
    CRViewer1.ReportSource = rDetail2
    CRViewer1.ViewReport
    rDetail2.DiscardSavedData
ElseIf J_CETAK = 30 Then
        If C_KEC = "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_OP_BANGUNAN.NO_BNG, DAT_OP_BANGUNAN.NO_FORMULIR_LSPOP, DAT_OP_BANGUNAN.THN_DIBANGUN_BNG, DAT_OP_BANGUNAN.THN_RENOVASI_BNG, DAT_OP_BANGUNAN.LUAS_BNG, DAT_OP_BANGUNAN.JML_LANTAI_BNG, DAT_OP_BANGUNAN.KONDISI_BNG, DAT_OP_BANGUNAN.JNS_KONSTRUKSI_BNG, DAT_OP_BANGUNAN.NILAI_SISTEM_BNG, DAT_OP_BANGUNAN.K_UTAMA, DAT_OP_BANGUNAN.K_MATERIAL, DAT_OP_BANGUNAN.K_FASILITAS, DAT_OP_BANGUNAN.J_SUSUT, DAT_OP_BANGUNAN.K_SUSUT, DAT_OP_BANGUNAN.K_NON_SUSUT, DAT_OP_BANGUNAN.KD_JPB," & _
            "QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, REF_JPB.NM_JPB FROM (DAT_OP_BANGUNAN INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB) INNER JOIN QOBJEKPAJAK ON (DAT_OP_BANGUNAN.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_OP_BANGUNAN.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_OP_BANGUNAN.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_OP_BANGUNAN.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_OP_BANGUNAN.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan) "
        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
            C_STR = "SELECT DAT_OP_BANGUNAN.NO_BNG, DAT_OP_BANGUNAN.NO_FORMULIR_LSPOP, DAT_OP_BANGUNAN.THN_DIBANGUN_BNG, DAT_OP_BANGUNAN.THN_RENOVASI_BNG, DAT_OP_BANGUNAN.LUAS_BNG, DAT_OP_BANGUNAN.JML_LANTAI_BNG, DAT_OP_BANGUNAN.KONDISI_BNG, DAT_OP_BANGUNAN.JNS_KONSTRUKSI_BNG, DAT_OP_BANGUNAN.NILAI_SISTEM_BNG, DAT_OP_BANGUNAN.K_UTAMA, DAT_OP_BANGUNAN.K_MATERIAL, DAT_OP_BANGUNAN.K_FASILITAS, DAT_OP_BANGUNAN.J_SUSUT, DAT_OP_BANGUNAN.K_SUSUT, DAT_OP_BANGUNAN.K_NON_SUSUT, DAT_OP_BANGUNAN.KD_JPB," & _
            "QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, REF_JPB.NM_JPB FROM (DAT_OP_BANGUNAN INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB) INNER JOIN QOBJEKPAJAK ON (DAT_OP_BANGUNAN.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_OP_BANGUNAN.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_OP_BANGUNAN.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_OP_BANGUNAN.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_OP_BANGUNAN.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan) where DAT_OP_BANGUNAN.KD_KECAMATAN='" & C_KEC & "' "
        Else
            C_STR = "SELECT DAT_OP_BANGUNAN.NO_BNG, DAT_OP_BANGUNAN.NO_FORMULIR_LSPOP, DAT_OP_BANGUNAN.THN_DIBANGUN_BNG, DAT_OP_BANGUNAN.THN_RENOVASI_BNG, DAT_OP_BANGUNAN.LUAS_BNG, DAT_OP_BANGUNAN.JML_LANTAI_BNG, DAT_OP_BANGUNAN.KONDISI_BNG, DAT_OP_BANGUNAN.JNS_KONSTRUKSI_BNG, DAT_OP_BANGUNAN.NILAI_SISTEM_BNG, DAT_OP_BANGUNAN.K_UTAMA, DAT_OP_BANGUNAN.K_MATERIAL, DAT_OP_BANGUNAN.K_FASILITAS, DAT_OP_BANGUNAN.J_SUSUT, DAT_OP_BANGUNAN.K_SUSUT, DAT_OP_BANGUNAN.K_NON_SUSUT, DAT_OP_BANGUNAN.KD_JPB," & _
            "QOBJEKPAJAK.SUBJEK_PAJAK_ID, QOBJEKPAJAK.NM_WP, QOBJEKPAJAK.JALAN_WP, QOBJEKPAJAK.KELURAHAN_WP, QOBJEKPAJAK.KOTA_WP, QOBJEKPAJAK.JALAN_OP, QOBJEKPAJAK.NM_KECAMATAN, QOBJEKPAJAK.NM_KELURAHAN, QOBJEKPAJAK.NOPQ, REF_JPB.NM_JPB FROM (DAT_OP_BANGUNAN INNER JOIN REF_JPB ON DAT_OP_BANGUNAN.KD_JPB = REF_JPB.KD_JPB) INNER JOIN QOBJEKPAJAK ON (DAT_OP_BANGUNAN.KD_JNS_OP = QOBJEKPAJAK.KD_JNS_OP) AND (DAT_OP_BANGUNAN.NO_URUT = QOBJEKPAJAK.NO_URUT) AND (DAT_OP_BANGUNAN.KD_BLOK = QOBJEKPAJAK.KD_BLOK) AND (DAT_OP_BANGUNAN.KD_KELURAHAN = QOBJEKPAJAK.KD_KELURAHAN) AND (DAT_OP_BANGUNAN.KD_KECAMATAN = QOBJEKPAJAK.KD_Kecamatan) where DAT_OP_BANGUNAN.KD_KECAMATAN='" & C_KEC & "' and DAT_OP_BANGUNAN.KD_KELURAHAN='" & C_KEL & "'"


        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rDETAIL.tJudul.SetText "TAHUN " & C_TAHUN
     rDETAIL.tNip.SetText "NIP. " & xNIP
    rDETAIL.tNama.SetText xNama
    rDETAIL.tJab.SetText xJabatan
    rDETAIL.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rDETAIL.Database.SetDataSource rPajak
    CRViewer1.ReportSource = rDETAIL
    CRViewer1.ViewReport
    rDETAIL.DiscardSavedData
ElseIf J_CETAK = 40 Then

        If C_KEC = "*.*" And C_KEL = "*.*" Then
                    C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP)) LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND  (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI"
        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
         C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP)) LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND  (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"where DAT_OBJEK_PAJAK.KD_KECAMATAN='" & C_KEC & "' GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI"
        Else
         C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP)) LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND  (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"where DAT_OBJEK_PAJAK.KD_KECAMATAN='" & C_KEC & "' AND DAT_OBJEK_PAJAK.KD_KELURAHAN='" & C_KEL & "' GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI"
        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai.tJudul1.SetText "LAPORAN PERBANDINGAN PENILAIAN OBJEK PAJAK TAHUN " & C_TAHUN
    rNilai.tNip.SetText "NIP. " & xNIP
    rNilai.tNama.SetText xNama
    rNilai.tkepala.SetText xJabatan
    rNilai.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai.Database.SetDataSource rPajak
    CRViewer1.ReportSource = rNilai
    CRViewer1.ViewReport
    rNilai.DiscardSavedData
ElseIf J_CETAK = 50 Then
'rNilai2.Section10.Suppress = True
        If C_KEC = "*.*" And C_KEL = "*.*" Then
            'c_str = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, Count(C_BUMI.NO_BUMI) AS JUM_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, C_OBJEK.TOTAL_LUAS_BNG, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN)" & _
                    "AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP)" & _
                    "GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.TOTAL_LUAS_BUMI, C_OBJEK.TOTAL_LUAS_BNG, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
            
C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"


        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
        C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) where C_OBJEK.KD_KECAMATAN='" & C_KEC & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
       
        Else
                C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) where C_OBJEK.KD_KECAMATAN='" & C_KEC & "' AND C_OBJEK.KD_KELURAHAN='" & C_KEL & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
 '       rNilai2.Section10.Suppress = False

        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai2.tJudul1.SetText "LAPORAN PERBANDINGAN PENILAIAN OBJEK PAJAK TAHUN " & Format(Now, "YYYY") - 1 'C_TAHUN - 1
    rNilai2.tNip.SetText "NIP. " & xNIP
    rNilai2.tNama.SetText xNama
    rNilai2.tkepala.SetText xJabatan
    rNilai2.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai2.Database.SetDataSource rPajak
    
    CRViewer1.ReportSource = rNilai2
    CRViewer1.ViewReport
    rNilai2.DiscardSavedData
ElseIf J_CETAK = 60 Then
'rNilai2.Section10.Suppress = True
        If C_KEC = "*.*" And C_KEL = "*.*" Then
            'c_str = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, Count(C_BUMI.NO_BUMI) AS JUM_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, C_OBJEK.TOTAL_LUAS_BNG, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN)" & _
                    "AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP)" & _
                    "GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.TOTAL_LUAS_BUMI, C_OBJEK.TOTAL_LUAS_BNG, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
            
'C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & C_TAHUN & "' as TAHUN FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) " & _
"INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP))" & _
"LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI UNION ALL " & _
"SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & (C_TAHUN * 1) - 1 & "' as TAHUN FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN)" & _
"INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP)" & _
"GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"





        ElseIf C_KEC <> "*.*" And C_KEL = "*.*" Then
'        C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) where C_OBJEK.KD_KECAMATAN='" & C_KEC & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & C_TAHUN & "' as TAHUN FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) " & _
"INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP))" & _
"LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"WHERE DAT_OBJEK_PAJAK.KD_KECAMATAN ='" & C_KEC & "' GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI UNION ALL " & _
"SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & (C_TAHUN * 1) - 1 & "' as TAHUN FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN)" & _
"INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP)" & _
"WHERE C_OBJEK.KD_KECAMATAN ='" & C_KEC & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
       
        Else
'                C_STR = "SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN))" & _
"INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP) where C_OBJEK.KD_KECAMATAN='" & C_KEC & "' AND C_OBJEK.KD_KELURAHAN='" & C_KEL & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"
 '       rNilai2.Section10.Suppress = False
C_STR = "SELECT DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI, Count(DAT_OP_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(DAT_OP_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(DAT_OP_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & C_TAHUN & "' as TAHUN FROM (((DAT_OBJEK_PAJAK INNER JOIN REF_KECAMATAN ON DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN) " & _
"INNER JOIN REF_KELURAHAN ON (DAT_OBJEK_PAJAK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN DAT_OP_BUMI ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BUMI.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BUMI.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BUMI.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BUMI.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BUMI.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BUMI.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BUMI.KD_JNS_OP))" & _
"LEFT JOIN DAT_OP_BANGUNAN ON (DAT_OBJEK_PAJAK.KD_PROPINSI = DAT_OP_BANGUNAN.KD_PROPINSI) AND (DAT_OBJEK_PAJAK.KD_DATI2 = DAT_OP_BANGUNAN.KD_DATI2) AND (DAT_OBJEK_PAJAK.KD_KECAMATAN = DAT_OP_BANGUNAN.KD_KECAMATAN) AND (DAT_OBJEK_PAJAK.KD_KELURAHAN = DAT_OP_BANGUNAN.KD_KELURAHAN) AND (DAT_OBJEK_PAJAK.KD_BLOK = DAT_OP_BANGUNAN.KD_BLOK) AND (DAT_OBJEK_PAJAK.NO_URUT = DAT_OP_BANGUNAN.NO_URUT) AND (DAT_OBJEK_PAJAK.KD_JNS_OP = DAT_OP_BANGUNAN.KD_JNS_OP) " & _
"WHERE DAT_OBJEK_PAJAK.KD_KECAMATAN ='" & C_KEC & "' and DAT_OBJEK_PAJAK.KD_KELURAHAN='" & C_KEL & "' GROUP BY DAT_OBJEK_PAJAK.KD_PROPINSI, DAT_OBJEK_PAJAK.KD_DATI2, DAT_OBJEK_PAJAK.KD_Kecamatan, DAT_OBJEK_PAJAK.KD_KELURAHAN, DAT_OP_BUMI.KD_BLOK, DAT_OP_BUMI.NO_URUT, DAT_OP_BUMI.KD_JNS_OP, DAT_OP_BUMI.NO_BUMI, DAT_OBJEK_PAJAK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, DAT_OP_BUMI.NILAI_SISTEM_BUMI UNION ALL " & _
"SELECT C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI, Count(C_BANGUNAN.NO_BNG) AS JUM_BNG, Sum(C_BANGUNAN.LUAS_BNG) AS TOT_LUAS_BNG, Sum(C_BANGUNAN.NILAI_SISTEM_BNG) AS TOT_NILAI_BNG,'" & (C_TAHUN * 1) - 1 & "' as TAHUN FROM (((C_OBJEK INNER JOIN REF_KECAMATAN ON C_OBJEK.KD_KECAMATAN = REF_KECAMATAN.KD_KECAMATAN)" & _
"INNER JOIN REF_KELURAHAN ON (C_OBJEK.KD_KECAMATAN = REF_KELURAHAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = REF_KELURAHAN.KD_KELURAHAN)) INNER JOIN C_BUMI ON (C_OBJEK.KD_KECAMATAN = C_BUMI.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BUMI.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BUMI.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BUMI.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BUMI.KD_JNS_OP)) LEFT JOIN C_BANGUNAN ON (C_OBJEK.KD_KECAMATAN = C_BANGUNAN.KD_KECAMATAN) AND (C_OBJEK.KD_KELURAHAN = C_BANGUNAN.KD_KELURAHAN) AND (C_OBJEK.KD_BLOK = C_BANGUNAN.KD_BLOK) AND (C_OBJEK.NO_URUT = C_BANGUNAN.NO_URUT) AND (C_OBJEK.KD_JNS_OP = C_BANGUNAN.KD_JNS_OP)" & _
"WHERE C_OBJEK.KD_KECAMATAN ='" & C_KEC & "' and C_OBJEK.KD_KELURAHAN='" & C_KEL & "' GROUP BY C_OBJEK.KD_PROPINSI, C_OBJEK.KD_DATI2, C_OBJEK.KD_Kecamatan, C_OBJEK.KD_KELURAHAN, C_OBJEK.KD_BLOK, C_OBJEK.NO_URUT, C_OBJEK.KD_JNS_OP, C_BUMI.NO_BUMI, C_OBJEK.TOTAL_LUAS_BUMI, REF_KECAMATAN.NM_KECAMATAN, REF_KELURAHAN.NM_KELURAHAN, C_BUMI.NILAI_SISTEM_BUMI"

        End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai3.tJudul1.SetText "LAPORAN PERBANDINGAN PENILAIAN OBJEK PAJAK TAHUN " & Format(Now, "YYYY") & " DENGAN TAHUN " & Format(Now, "YYYY") - 1 'C_TAHUN - 1
    rNilai3.tNip.SetText "NIP. " & xNIP
    rNilai3.tNama.SetText xNama
    rNilai3.tkepala.SetText xJabatan
    rNilai3.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
    rNilai3.Database.SetDataSource rPajak
    CRViewer1.ReportSource = rNilai3
    CRViewer1.ViewReport
    rNilai3.DiscardSavedData

ElseIf J_CETAK = 6 Then
    Me.Caption = "Cetak Daftar Komponen Biaya Bangunan (DBKB) " & C_TAHUN
    Select Case K_JPB
    Case "01" 'PERUMAHAN DAN BANGUNAN STANDARD
        C_STR = "SELECT DBKB_STANDARD.*, TIPE_BANGUNAN.LUAS_MIN_TIPE_BNG, TIPE_BANGUNAN.LUAS_MAX_TIPE_BNG, DBKB_STANDARD.THN_DBKB_STANDARD, REF_JPB.NM_JPB FROM (DBKB_STANDARD INNER JOIN TIPE_BANGUNAN ON DBKB_STANDARD.TIPE_BNG = TIPE_BANGUNAN.TIPE_BNG) INNER JOIN REF_JPB ON DBKB_STANDARD.KD_JPB = REF_JPB.KD_JPB WHERE DBKB_STANDARD.THN_DBKB_STANDARD='" & C_TAHUN & "' ORDER BY DBKB_STANDARD.KD_BNG_LANTAI,DBKB_STANDARD.KD_JPB"
        Set rSEM = New rKelas2
        zSEM = 1
    Case "02" 'PERKANTORAN
        C_STR = "SELECT * FROM DBKB_JPB2 where THN_DBKB_JPB2='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB2 ASC, LANTAI_MIN_JPB2 ASC,KLS_DBKB_JPB2 DESC"
         Set rSEM = New rKantor
         zSEM = 2
    Case "03" 'PABRIK
        C_STR = "SELECT * FROM DBKB_JPB3 WHERE THN_DBKB_JPB3='" & C_TAHUN & "' ORDER BY TING_KOLOM_MAX_DBKB_JPB3,TING_KOLOM_MIN_DBKB_JPB3,LBR_BENT_MAX_DBKB_JPB3,LBR_BENT_MIN_DBKB_JPB3"
        Set rSEM = New rPabrik
        zSEM = 3
    Case "04" 'PERTOKOAN/APOTIK/PASAR/RUKO
        C_STR = "SELECT * FROM DBKB_JPB4 where THN_DBKB_JPB4='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB4 ASC, LANTAI_MIN_JPB4 ASC,KLS_DBKB_JPB4 DESC"
        Set rSEM = New rToko
        zSEM = 4
    Case "05" 'RUMAH SAKIT/KLINIK
        C_STR = "SELECT * FROM DBKB_JPB5 where THN_DBKB_JPB5='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB5 ASC, LANTAI_MIN_JPB5 ASC,KLS_DBKB_JPB5 DESC"
        Set rSEM = New rRSakit
        zSEM = 5
    Case "06" 'OLAHRAGA/REKREASI GABUNG KE PARKIR
        GoTo Keluar
        'C_STR = "SELECT * FROM DBKB_JPB4 where THN_DBKB_JPB4='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB4 ASC, LANTAI_MIN_JPB4 ASC,KLS_DBKB_JPB4 DESC"
    Case "07" 'HOTEL/WISMA
        C_STR = "SELECT * FROM DBKB_JPB7 where THN_DBKB_JPB7='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB7 ASC, LANTAI_MIN_JPB7 ASC,BINTANG_DBKB_JPB7 DESC,JNS_DBKB_JPB7 ASC"
        Set rSEM = New rHotel
        zSEM = 6
    Case "08" 'BENGKEL/GUDANG/PERTANIAN
        C_STR = "SELECT * FROM DBKB_JPB8 WHERE THN_DBKB_JPB8='" & C_TAHUN & "' ORDER BY TING_KOLOM_MAX_DBKB_JPB8,TING_KOLOM_MIN_DBKB_JPB8,LBR_BENT_MAX_DBKB_JPB8,LBR_BENT_MIN_DBKB_JPB8"
            Set rSEM = New rKelas2B
            zSEM = 7
    Case "09" 'GEDUNG PEMERINTAH(TIDAK DICETAK)
            GoTo Keluar
    Case "10"
        GoTo Keluar
    Case "11"
        GoTo Keluar
    Case "12" 'BANGUNAN PARKIR
        C_STR = "SELECT * FROM DBKB_JPB12 where THN_DBKB_JPB12='" & C_TAHUN & "' ORDER BY TYPE_DBKB_JPB12"
        Set rSEM = New rParkir
        zSEM = 8
    Case "13" 'APARTEMEN
        C_STR = "SELECT * FROM DBKB_JPB13 where THN_DBKB_JPB13='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB13 ASC, LANTAI_MIN_JPB13 ASC,KLS_DBKB_JPB13 DESC"
        Set rSEM = New rApartemen
        zSEM = 9
    Case "14" 'KANOPI POMPA MINYAK (GABUNG DENGAN DAYA DUKUNG)
        C_STR = "SELECT DAYA_DUKUNG.TYPE_KONSTRUKSI, DAYA_DUKUNG.DAYA_DUKUNG_LANTAI_MIN_DBKB, DAYA_DUKUNG.DAYA_DUKUNG_LANTAI_MAX_DBKB, DBKB_DAYA_DUKUNG.NILAI_DBKB_DAYA_DUKUNG FROM DBKB_DAYA_DUKUNG INNER JOIN DAYA_DUKUNG ON DBKB_DAYA_DUKUNG.TYPE_KONSTRUKSI = DAYA_DUKUNG.TYPE_KONSTRUKSI where DBKB_DAYA_DUKUNG.THN_DBKB_DAYA_DUKUNG='" & C_TAHUN & "'"
            Set rSEM = New rDukung
            zSEM = 10
    Case "15" 'TANGKI MINYAK
        C_STR = "SELECT * FROM DBKB_JPB15 WHERE THN_DBKB_JPB15='" & C_TAHUN & "' ORDER BY KAPASITAS_MAX_DBKB_JPB15,KAPASITAS_MIN_DBKB_JPB15,JNS_TANGKI_DBKB_JPB15"
        Set rSEM = New rTangki
        zSEM = 11
    Case "16" 'GEDUNG SEKOLAH
        C_STR = "SELECT * FROM DBKB_JPB16 where THN_DBKB_JPB16='" & C_TAHUN & "' ORDER BY LANTAI_MAX_JPB16 ASC, LANTAI_MIN_JPB16 ASC,KLS_DBKB_JPB16 DESC"
        Set rSEM = New rSekolah
        zSEM = 12
    Case "17" 'FASILITAS 1 (FAS_DEP_JPB_KLS_BINTANG)
        C_STR = "SELECT FASILITAS.KD_FASILITAS, FASILITAS.NM_FASILITAS, FAS_DEP_JPB_KLS_BINTANG.KLS_BINTANG, FAS_DEP_JPB_KLS_BINTANG.NILAI_FASILITAS_KLS_BINTANG, FAS_DEP_JPB_KLS_BINTANG.THN_DEP_JPB_KLS_BINTANG FROM FASILITAS INNER JOIN FAS_DEP_JPB_KLS_BINTANG ON FASILITAS.KD_FASILITAS = FAS_DEP_JPB_KLS_BINTANG.KD_FASILITAS WHERE FAS_DEP_JPB_KLS_BINTANG.THN_DEP_JPB_KLS_BINTANG='" & C_TAHUN & "'"
        Set rSEM = New rFas
        zSEM = 13
    Case "18" 'FASILITAS 2 (FAS_DEP_MIN_MAX)
        C_STR = "SELECT FASILITAS.KD_FASILITAS, FASILITAS.NM_FASILITAS, FAS_DEP_MIN_MAX.THN_DEP_MIN_MAX, FAS_DEP_MIN_MAX.KLS_DEP_MIN, FAS_DEP_MIN_MAX.KLS_DEP_MAX, FAS_DEP_MIN_MAX.NILAI_DEP_MIN_MAX FROM FASILITAS INNER JOIN FAS_DEP_MIN_MAX ON FASILITAS.KD_FASILITAS = FAS_DEP_MIN_MAX.KD_FASILITAS WHERE FAS_DEP_MIN_MAX.THN_DEP_MIN_MAX='" & C_TAHUN & "'"
        Set rSEM = New rFas1
        zSEM = 14
    Case "19" 'FASILITAS 3 (FAS_NON_DEP)
        C_STR = "SELECT FASILITAS.KD_FASILITAS, FASILITAS.NM_FASILITAS, FAS_NON_DEP.THN_NON_DEP, FAS_NON_DEP.NILAI_NON_DEP FROM FASILITAS INNER JOIN FAS_NON_DEP ON FASILITAS.KD_FASILITAS = FAS_NON_DEP.KD_FASILITAS WHERE FAS_NON_DEP.THN_NON_DEP='" & C_TAHUN & "'"
        Set rSEM = New rFas2
        zSEM = 15
    Case "20" 'MATERIAL
        C_STR = "SELECT DBKB_MATERIAL.KD_PROPINSI, DBKB_MATERIAL.KD_DATI2, DBKB_MATERIAL.THN_DBKB_MATERIAL, PEKERJAAN.KD_PEKERJAAN, PEKERJAAN.NM_PEKERJAAN, PEKERJAAN.STATUS_PEKERJAAN, PEKERJAAN_KEGIATAN.KD_KEGIATAN, PEKERJAAN_KEGIATAN.NM_KEGIATAN, DBKB_MATERIAL.NILAI_DBKB_MATERIAL FROM (PEKERJAAN INNER JOIN PEKERJAAN_KEGIATAN ON PEKERJAAN.KD_PEKERJAAN = PEKERJAAN_KEGIATAN.KD_PEKERJAAN) INNER JOIN DBKB_MATERIAL ON (PEKERJAAN_KEGIATAN.KD_KEGIATAN = DBKB_MATERIAL.KD_KEGIATAN) AND (PEKERJAAN_KEGIATAN.KD_PEKERJAAN = DBKB_MATERIAL.KD_PEKERJAAN) WHERE DBKB_MATERIAL.THN_DBKB_MATERIAL='" & C_TAHUN & "' order by PEKERJAAN_KEGIATAN.NM_KEGIATAN"
        Set rSEM = New rMaterial
        rSEM.tNip.SetText "NIP. " & xNIP
        rSEM.tNama.SetText xNama
        rSEM.tJab.SetText xJabatan
        rSEM.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
        zSEM = 16

    End Select
        openDB (C_STR)
        
        rSEM.tJudul.SetText "TAHUN " & C_TAHUN
        If rPajak.RecordCount > 0 Then rPajak.MoveFirst
        rSEM.Database.SetDataSource rPajak
        CRViewer1.ReportSource = rSEM
        CRViewer1.ViewReport
        rSEM.DiscardSavedData


ElseIf J_CETAK = 111 Then
    If CetakQ = 1 Then
       ' MsgBox Trim(frmCetakLog.aNOP.Text)
        C_STR = "SELECT * from LogUtama where NOP1='" & Trim(frmCetakLog.aNOP.Text) & "' and xFLAG='1' order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 2 Then
        C_STR = "SELECT * from LogUtama where (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
        
        '& _
                " AND (DAY(TGL_PEREKAMAN_OP)*1>='" & Day(frmCetakLog.dRekam1.Value) * 1 & "'" & _
                " OR MONTH(TGL_PEREKAMAN_OP)*1>='" & Month(frmCetakLog.dRekam1.Value) * 1 & "'" & _
                " OR YEAR(TGL_PEREKAMAN_OP)*1>='" & Year(frmCetakLog.dRekam1.Value) * 1 & "')" & _
                " AND (DAY(TGL_PEREKAMAN_OP)*1<='" & Day(frmCetakLog.dRekam2.Value) * 1 & "'" & _
                " OR MONTH(TGL_PEREKAMAN_OP)*1<='" & Month(frmCetakLog.dRekam2.Value) * 1 & "'" & _
                " OR YEAR(TGL_PEREKAMAN_OP)*1<='" & Year(frmCetakLog.dRekam2.Value) * 1 & "')" & _
                "order by TGL_PEREKAMAN_OP asc"
        'C_STR = "SELECT * from LogUtama where xFLAG='1' and ((day(TGL_PEREKAMAN_OP)+'/'+month(tgl_perekaman_op)+'/'+year(tgl_perekaman_op)>='" & Format(frmCetakLog.dRekam1.Value, "YYYY/MM/DD") & "' AND (year(TGL_PEREKAMAN_OP)+'/'+month(tgl_perekaman_op)+'/'+day(tgl_perekaman_op)<='" & Format(frmCetakLog.dRekam2.Value, "YYYY/MM/DD") & "') order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 3 Then
        C_STR = "SELECT * from LogUtama order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 4 Then
        C_STR = "SELECT * from LogUtama where SUBSTRING(NOP1,7,3)='" & C_KEC & "'AND (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 5 Then
        C_STR = "SELECT * from LogUtama where  SUBSTRING(NOP1,7,3)='" & C_KEC & "' order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 6 Then
        C_STR = "SELECT * from LogUtama where SUBSTRING(NOP1,7,3)='" & C_KEC & "' AND SUBSTRING(NOP1,11,3)='" & C_KEL & "'AND (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
        
    ElseIf CetakQ = 7 Then
        C_STR = "SELECT * from LogUtama where  SUBSTRING(NOP1,7,3)='" & C_KEC & "' AND SUBSTRING(NOP1,11,3)='" & C_KEL & "' order by TGL_PEREKAMAN_OP asc"
    End If
    openDB (C_STR)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
'    rNilai2.tJudul1.SetText "LAPORAN PERBANDINGAN PENILAIAN OBJEK PAJAK TAHUN " & Format(Now, "YYYY") - 1 'C_TAHUN - 1
'    rNilai2.tNIP.SetText "NIP. " & xNIP
'    rNilai2.tNama.SetText xNama
'    rNilai2.tkepala.SetText xJabatan
'    rNilai2.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    rLog1.Text3.SetText "LOG PERUBAHAN, PENGHAPUSAN OBJEK PAJAK TAHUN " & Format(Now, "YYYY")
    rLog1.Database.SetDataSource rPajak
    
    CRViewer1.ReportSource = rLog1
    CRViewer1.ViewReport
    rLog1.DiscardSavedData
ElseIf J_CETAK = 112 Then
    'C_STR = "SELECT * from LogUtama where xFLAG='1' order by TGL_PEREKAMAN_OP asc"
    If CetakQ = 1 Then
       ' MsgBox Trim(frmCetakLog.aNOP.Text)
        C_STR = "SELECT * from LogUtama where NOP1='" & Trim(frmCetakLog.aNOP.Text) & "' and xFLAG='1' order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 2 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' AND (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
        
        '& _
                " AND (DAY(TGL_PEREKAMAN_OP)*1>='" & Day(frmCetakLog.dRekam1.Value) * 1 & "'" & _
                " OR MONTH(TGL_PEREKAMAN_OP)*1>='" & Month(frmCetakLog.dRekam1.Value) * 1 & "'" & _
                " OR YEAR(TGL_PEREKAMAN_OP)*1>='" & Year(frmCetakLog.dRekam1.Value) * 1 & "')" & _
                " AND (DAY(TGL_PEREKAMAN_OP)*1<='" & Day(frmCetakLog.dRekam2.Value) * 1 & "'" & _
                " OR MONTH(TGL_PEREKAMAN_OP)*1<='" & Month(frmCetakLog.dRekam2.Value) * 1 & "'" & _
                " OR YEAR(TGL_PEREKAMAN_OP)*1<='" & Year(frmCetakLog.dRekam2.Value) * 1 & "')" & _
                "order by TGL_PEREKAMAN_OP asc"
        'C_STR = "SELECT * from LogUtama where xFLAG='1' and ((day(TGL_PEREKAMAN_OP)+'/'+month(tgl_perekaman_op)+'/'+year(tgl_perekaman_op)>='" & Format(frmCetakLog.dRekam1.Value, "YYYY/MM/DD") & "' AND (year(TGL_PEREKAMAN_OP)+'/'+month(tgl_perekaman_op)+'/'+day(tgl_perekaman_op)<='" & Format(frmCetakLog.dRekam2.Value, "YYYY/MM/DD") & "') order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 3 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 4 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' and SUBSTRING(NOP1,7,3)='" & C_KEC & "'AND (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 5 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' and SUBSTRING(NOP1,7,3)='" & C_KEC & "' order by TGL_PEREKAMAN_OP asc"
    ElseIf CetakQ = 6 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' and  SUBSTRING(NOP1,7,3)='" & C_KEC & "' AND SUBSTRING(NOP1,11,3)='" & C_KEL & "' AND (CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)>='" & Format(frmCetakLog.dRekam1.Value, "DD-MM-YYYY") & "' AND CONVERT(VARCHAR(10),TGL_PEREKAMAN_OP,110)<= '" & Format(frmCetakLog.dRekam2.Value, "DD-MM-YYYY") & "') order by TGL_PEREKAMAN_OP asc"
        
    ElseIf CetakQ = 7 Then
        C_STR = "SELECT * from LogUtama where xFLAG='1' and SUBSTRING(NOP1,7,3)='" & C_KEC & "' AND SUBSTRING(NOP1,11,3)='" & C_KEL & "' order by TGL_PEREKAMAN_OP asc"
    End If
    openDB (C_STR)
'    MsgBox Left(rPajak!TGL_PEREKAMAN_OP, 10)
    If rPajak.RecordCount > 0 Then rPajak.MoveFirst
'    rNilai2.tJudul1.SetText "LAPORAN PERBANDINGAN PENILAIAN OBJEK PAJAK TAHUN " & Format(Now, "YYYY") - 1 'C_TAHUN - 1
'    rNilai2.tNIP.SetText "NIP. " & xNIP
'    rNilai2.tNama.SetText xNama
'    rNilai2.tkepala.SetText xJabatan
'    rNilai2.tTanggal.SetText "Salak, " & Format(Now, "dd mmmm yyyy")
    rLog2.Text3.SetText "LOG PERUBAHAN KETETAPAN PAJAK BARU TAHUN " & Format(Now, "YYYY")
    rLog2.Database.SetDataSource rPajak
    
    CRViewer1.ReportSource = rLog2
    CRViewer1.ViewReport
    rLog2.DiscardSavedData

End If
Keluar:

If Err.Number = 0 Then Screen.MousePointer = vbDefault: Exit Sub
Salah:
If Err.Number = 0 Then Screen.MousePointer = vbDefault: Exit Sub
MsgBox Err.Number & ": " & Err.Description

Screen.MousePointer = vbDefault


c_Ganti = 1
End Sub

Private Sub Form_Resize()
On Error Resume Next
CRViewer1.Top = 0
CRViewer1.Left = 0
CRViewer1.Height = ScaleHeight
CRViewer1.Width = ScaleWidth

End Sub


Sub C_PEJABAT()
On Error GoTo Salah
C_STR = "SELECT * FROM PEJABAT"
openDB (C_STR)
If rPajak.RecordCount > 0 Then rPajak.MoveFirst
Do While Not rPajak.EOF
    xNIP = rPajak!NIP
    xNama = rPajak!NAMA
    xJabatan = rPajak!JABATAN
    rPajak.MoveNext
Loop
If Err.Number = 0 Then Screen.MousePointer = vbDefault: Exit Sub
Salah:
If Err.Number = 0 Then Screen.MousePointer = vbDefault: Exit Sub
MsgBox Err.Number & ": " & Err.Description

End Sub

Private Sub Form_Unload(Cancel As Integer)
On Error Resume Next
frmUtama.mnSetting.Enabled = False
xID = 100
End Sub
