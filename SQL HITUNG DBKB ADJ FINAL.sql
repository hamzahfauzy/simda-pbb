USE DBPAJAK 
GO
IF EXISTS(SELECT 1 FROM sys.procedures
          WHERE Name = 'HITUNG_DBKB_FINAL')
BEGIN
    DROP PROC HITUNG_DBKB_FINAL
END
GO
CREATE PROCEDURE HITUNG_DBKB_FINAL
@VLC_THN_DBKB_FINAL NVARCHAR(4)
 AS
 BEGIN
   DECLARE
  @VLC_KD_JPB               NVARCHAR(2),
  @VLC_TIPE_BNG             NVARCHAR(5),
  @VLC_KD_BNG_LANTAI        NVARCHAR(8),
  @VLN_NILAI_DBKB_STANDARD  FLOAT,
  @VLC_KD_ADJ               NVARCHAR(2),
  @VLN_PCT_ADJ_BNG          FLOAT,
  @VLN_DBKB_STANDARD2_2_216 FLOAT,
  @VLN_DBKB_STANDARD5_2_216 FLOAT,
  @VLN_DBKB_STANDARD2_2_432 FLOAT,
  @VLN_DBKB_STANDARD5_2_432 FLOAT,
  @VLN_DBKB_STANDARD2_2_648 FLOAT,
  @VLN_DBKB_STANDARD5_2_648 FLOAT,
  @VLN_DBKB_STANDARD2_2_864 FLOAT,
  @VLN_DBKB_STANDARD5_2_864 FLOAT,
  @VLN_DBKB_STANDARD2_2_262 FLOAT,
  @VLN_DBKB_STANDARD5_2_262 FLOAT,
  @VLN_DBKB_STANDARD1_1_045 FLOAT,
  @VLN_ADJ_LUAS1_1_045      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_045 FLOAT,
  @VLN_ADJ_BNG1_1_045       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_045  FLOAT,
  @VLN_STLH_ADJ_BNG5_1_045  FLOAT,
  @VLN_STLH_ADJ_BNG5_2_045  FLOAT,
  @VLN_DBKB_STANDARD1_1_076 FLOAT,
  @VLN_ADJ_LUAS1_1_076      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_076 FLOAT,
  @VLN_ADJ_BNG1_1_076       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_076  FLOAT,
  @VLN_STLH_ADJ_BNG5_1_076  FLOAT,
  @VLN_STLH_ADJ_BNG5_2_076  FLOAT,
  @VLN_DBKB_STANDARD1_1_145 FLOAT,
  @VLN_ADJ_LUAS1_1_145      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_145 FLOAT,
  @VLN_ADJ_BNG1_1_145       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_145  FLOAT,
  @VLN_STLH_ADJ_BNG5_1_134  FLOAT,
  @VLN_DBKB_STANDARD1_1_150 FLOAT,
  @VLN_ADJ_LUAS1_1_150      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_150 FLOAT,
  @VLN_ADJ_BNG1_1_150       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_150  FLOAT,
  @VLN_STLH_ADJ_BNG5_1_216  FLOAT,
  @VLN_DBKB_STANDARD1_1_295 FLOAT,
  @VLN_ADJ_LUAS1_1_295      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_295 FLOAT,
  @VLN_ADJ_BNG1_1_295       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_295  FLOAT,
  @VLN_STLH_ADJ_BNG5_1_265  NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_1_314 NUMERIC(12,2),
  @VLN_ADJ_LUAS1_1_314      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_314 NUMERIC(12,2),
  @VLN_ADJ_BNG1_1_314       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_314  NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG5_1_432  NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_1_500 NUMERIC(12,2),
  @VLN_ADJ_LUAS1_1_500      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_500 NUMERIC(12,2),
  @VLN_ADJ_BNG1_1_500       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_500  NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG5_1_648  NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_1_656 NUMERIC(12,2),
  @VLN_ADJ_LUAS1_1_656      FLOAT,
  @VLN_STLH_ADJ_LUAS1_1_656 NUMERIC(12,2),
  @VLN_ADJ_BNG1_1_656       FLOAT,
  @VLN_STLH_ADJ_BNG1_1_656  NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG5_1_864  NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_134 NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_134      FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_134 NUMERIC(12,2),
  @VLN_ADJ_BNG1_2_134       FLOAT,
  @VLN_STLH_ADJ_BNG1_2_134  NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG5_2_134  NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_045      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_045      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_045      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_045      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_2_045      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_076      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_076      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_076      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_2_076      NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_076      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_134      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_134      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_216      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_216      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_262      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_265      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_432      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_432      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_648      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_648      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_1_864      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_1_864      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_134      NUMERIC(12,2),
  @VLN_DBKB_STANDARD5_2_134      NUMERIC(12,2),
  @VLN_NILAI_AKHIR               NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_216A     NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_432V     NUMERIC(12,2),
  @VCEK                          CHAR(2),
  @VLN_DBKB_STANDARD1_2_257      NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_257           FLOAT,
  @VLN_ADJ_BNG1_2_257            FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_257      NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG1_2_257       NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_218      NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_218           FLOAT,
  @VLN_ADJ_BNG1_2_218            FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_218      NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG1_2_218       NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_555      NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_555           FLOAT,
  @VLN_ADJ_BNG1_2_555            FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_555      NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG1_2_555       NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_474      NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_474           FLOAT,
  @VLN_ADJ_BNG1_2_474            FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_474      NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG1_2_474       NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_474V     NUMERIC(12,2),
  @VLN_ADJ_LUAS1_2_375           FLOAT,
  @VLN_ADJ_BNG1_2_375            FLOAT,
  @VLN_STLH_ADJ_LUAS1_2_375      NUMERIC(12,2),
  @VLN_STLH_ADJ_BNG1_2_375       NUMERIC(12,2),
  @VLN_DBKB_STANDARD1_2_375      NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_432A     NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_648A     NUMERIC(12,2),
  @VLN_DBKB_STANDARD2_2_864A     NUMERIC(12,2)

DECLARE C_JPB_TIPEBNG_BNGLANTAI_NILAI2 CURSOR FOR
SELECT DISTINCT A.KD_JPB,A.TIPE_BNG,A.KD_BNG_LANTAI,A.NILAI_DBKB_STANDARD FROM DBKB_STANDARD A,HRG_KEGIATAN B
WHERE  A.KD_PROPINSI=B.KD_PROPINSI AND
       A.KD_DATI2=B.KD_DATI2 AND
       A.THN_DBKB_STANDARD=B.THN_KEGIATAN AND
	   --A.KD_PROPINSI=VLC_KD_PROPINSI AND
	   --A.KD_DATI2=VLC_KD_DATI2 AND
	   A.THN_DBKB_STANDARD=@VLC_THN_DBKB_FINAL
	   ORDER BY A.KD_BNG_LANTAI
 OPEN C_JPB_TIPEBNG_BNGLANTAI_NILAI2
 FETCH C_JPB_TIPEBNG_BNGLANTAI_NILAI2 INTO @VLC_KD_JPB,@VLC_TIPE_BNG,@VLC_KD_BNG_LANTAI,@VLN_NILAI_DBKB_STANDARD
 WHILE @@FETCH_STATUS = 0
 BEGIN
	------------------------------------------------
	/*BUAT VARIABLE-VARIABLE UNTUK MENYIMPAN NILAI*/
	------------------------------------------------

	--KD_BNG_LANTAI = 1_1_045
	-------------------------
    IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_045' 
    BEGIN
	   SET @VLN_DBKB_STANDARD1_1_045 = @VLN_NILAI_DBKB_STANDARD
	   SELECT @VLN_ADJ_LUAS1_1_045=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_045'

	   IF (@VLN_ADJ_LUAS1_1_045) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_045 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_1_045 = @VLN_DBKB_STANDARD1_1_045 +
	                               @VLN_ADJ_LUAS1_1_045

	   SELECT @VLN_ADJ_BNG1_1_045=((100+SUM(PCT_ADJ_BNG))/100)FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_045'

	   IF (@VLN_ADJ_BNG1_1_045) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_045 = 0
	   END 

       SET @VLN_STLH_ADJ_BNG1_1_045 = (@VLN_STLH_ADJ_LUAS1_1_045 *
	                              @VLN_ADJ_BNG1_1_045)

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_045
	END

	--KD_BNG_LANTAI = 1_1_076
	-------------------------
    IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_076' 
    BEGIN
	   SET @VLN_DBKB_STANDARD1_1_076 = @VLN_NILAI_DBKB_STANDARD
	   
	   SELECT @VLN_ADJ_LUAS1_1_076=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_076'

	   IF (@VLN_ADJ_LUAS1_1_076) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_076 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_076 = @VLN_DBKB_STANDARD1_1_076 +
	                               @VLN_ADJ_LUAS1_1_076

	   SELECT @VLN_ADJ_BNG1_1_076=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_076'

	   IF (@VLN_ADJ_BNG1_1_076) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_076 = 0
	   END 

       SET @VLN_STLH_ADJ_BNG1_1_076 = (@VLN_STLH_ADJ_LUAS1_1_076 *
	                              @VLN_ADJ_BNG1_1_076)

	   IF (@VLN_STLH_ADJ_BNG1_1_076) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_076 = 0
	   END 
       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_076
	END 

	--KD_BNG_LANTAI = 1_1_145
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_145' 
	BEGIN
	   SET @VLN_DBKB_STANDARD1_1_145 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_1_145=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_145'

	   IF (@VLN_ADJ_LUAS1_1_145) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_145 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_145 = @VLN_DBKB_STANDARD1_1_145 +
	                               @VLN_ADJ_LUAS1_1_145

	   SELECT @VLN_ADJ_BNG1_1_145=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_145'

	   IF (@VLN_ADJ_BNG1_1_145) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_145 = 0
	   END 

       SET @VLN_STLH_ADJ_BNG1_1_145 = (@VLN_STLH_ADJ_LUAS1_1_145 *
	                              @VLN_ADJ_BNG1_1_145)

	   IF (@VLN_STLH_ADJ_BNG1_1_145) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_145 = 0
	   END 
	      SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_145
	END 

	--KD_BNG_LANTAI = 1_1_150
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_150' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_1_150 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_1_150=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_150'

	   IF (@VLN_ADJ_LUAS1_1_150) is null
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_150 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_150 = @VLN_DBKB_STANDARD1_1_150 +
	                               @VLN_ADJ_LUAS1_1_150

	   SELECT @VLN_ADJ_BNG1_1_150=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_150'

       IF (@VLN_ADJ_BNG1_1_150) is null
       BEGIN
	      SET @VLN_ADJ_BNG1_1_150 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_1_150 = (@VLN_STLH_ADJ_LUAS1_1_150 *
	                              @VLN_ADJ_BNG1_1_150)

	   IF (@VLN_STLH_ADJ_BNG1_1_150) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_150 = 0
	   END 

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_150
	END 

	--KD_BNG_LANTAI = 1_1_295
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_295' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_1_295 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_1_295=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_295'

	   IF (@VLN_ADJ_LUAS1_1_295) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_295 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_295 = @VLN_DBKB_STANDARD1_1_295 +
	                               @VLN_ADJ_LUAS1_1_295

	   SELECT @VLN_ADJ_BNG1_1_295=((100+SUM(PCT_ADJ_BNG))/100)FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_295'

	   IF (@VLN_ADJ_BNG1_1_295) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_295 = 0
	   END 

       SET @VLN_STLH_ADJ_BNG1_1_295 = @VLN_STLH_ADJ_LUAS1_1_295 *
	                              @VLN_ADJ_BNG1_1_295

	   IF (@VLN_STLH_ADJ_BNG1_1_295) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_295 = 0
	   END 

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_295
	 END 

	--KD_BNG_LANTAI = 1_1_314
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_314' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_1_314 = @VLN_NILAI_DBKB_STANDARD

       SELECT @VLN_ADJ_LUAS1_1_314=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_314'

	   IF (@VLN_ADJ_LUAS1_1_314) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_314 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_314 = @VLN_DBKB_STANDARD1_1_314 +
	                               @VLN_ADJ_LUAS1_1_314

       SELECT @VLN_ADJ_BNG1_1_314=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_314'

	   IF (@VLN_ADJ_BNG1_1_314) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_314 = 0
	   END 

       SET @VLN_STLH_ADJ_BNG1_1_314 = @VLN_STLH_ADJ_LUAS1_1_314 *
	                              @VLN_ADJ_BNG1_1_314

       IF (@VLN_STLH_ADJ_BNG1_1_314) = 0 
       BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_314 = 0
	   END 

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_314
	 END 

	--KD_BNG_LANTAI = 1_1_500
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_500' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_1_500 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_1_500=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_500'

	   IF (@VLN_ADJ_LUAS1_1_500) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_500 = 0
	   END 

       SET @VLN_STLH_ADJ_LUAS1_1_500 = @VLN_DBKB_STANDARD1_1_500 +
	                               @VLN_ADJ_LUAS1_1_500

	   SELECT @VLN_ADJ_BNG1_1_500=((100+SUM(PCT_ADJ_BNG))/100)FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_500'

	   IF (@VLN_ADJ_BNG1_1_500) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_500 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_1_500 = (@VLN_STLH_ADJ_LUAS1_1_500 *
	                              @VLN_ADJ_BNG1_1_500)

	   IF @VLN_STLH_ADJ_BNG1_1_500 IS NULL 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_500 = 0
	   END

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_500
	END

	--KD_BNG_LANTAI = 1_1_656
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_1_656' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_1_656 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_1_656=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_656'

	   IF (@VLN_ADJ_LUAS1_1_656) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_1_656 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_1_656 = @VLN_DBKB_STANDARD1_1_656 +
	                               @VLN_ADJ_LUAS1_1_656

	   SELECT @VLN_ADJ_BNG1_1_656=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_1_656'

	   IF (@VLN_ADJ_BNG1_1_656) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_1_656 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_1_656 = (@VLN_STLH_ADJ_LUAS1_1_656 *
	                              @VLN_ADJ_BNG1_1_656)

	   IF (@VLN_STLH_ADJ_BNG1_1_656) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_1_656 = 0
	   END

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_656
	END

	--KD_BNG_LANTAI = 1_2_218
	-------------------------
    IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_218' 
    BEGIN
	   SET @VLN_DBKB_STANDARD1_2_218 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_218=PCT_ADJ_LUAS FROM   ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_218'

	   IF (@VLN_ADJ_LUAS1_2_218) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_218 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_218 = @VLN_DBKB_STANDARD1_2_218 +
	                               @VLN_ADJ_LUAS1_2_218

	   SELECT @VLN_ADJ_BNG1_2_218=((100+SUM(PCT_ADJ_BNG))/100) FROM   ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_218'

	   IF (@VLN_ADJ_BNG1_2_218) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_218 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_218 = (@VLN_STLH_ADJ_LUAS1_2_218 *
	                              @VLN_ADJ_BNG1_2_218)

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_218
	END

	--KD_BNG_LANTAI = 1_2_257
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_257' 
	BEGIN
	   SET @VLN_DBKB_STANDARD1_2_257 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_257=PCT_ADJ_LUAS FROM   ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_257'

	   IF (@VLN_ADJ_LUAS1_2_257) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_257 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_257 = @VLN_DBKB_STANDARD1_2_257 +
	                               @VLN_ADJ_LUAS1_2_257

	   SELECT @VLN_ADJ_BNG1_2_257=((100+SUM(PCT_ADJ_BNG))/100)FROM   ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_257'

	   IF (@VLN_ADJ_BNG1_2_257) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_257 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_257 = (@VLN_STLH_ADJ_LUAS1_2_257 *
	                               @VLN_ADJ_BNG1_2_257)

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_257
	END


	--KD_BNG_LANTAI = 1_2_474
	-------------------------
    IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_474' 
    BEGIN
	   SET @VLN_DBKB_STANDARD1_2_474 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_474= PCT_ADJ_LUAS FROM   ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_474'

	   IF (@VLN_ADJ_LUAS1_2_474) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_474 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_474 = @VLN_DBKB_STANDARD1_2_474 +
	                               @VLN_ADJ_LUAS1_2_474

	   SELECT @VLN_ADJ_BNG1_2_474=((100+SUM(PCT_ADJ_BNG))/100) FROM   ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_474'

	   IF (@VLN_ADJ_BNG1_2_474) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_474 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_474 = (@VLN_STLH_ADJ_LUAS1_2_474 *
	                              @VLN_ADJ_BNG1_2_474)

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_474
	END

	--KD_BNG_LANTAI = 1_2_555
	-------------------------
    IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_555' 
    BEGIN
	   SET @VLN_DBKB_STANDARD1_2_555 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_555=PCT_ADJ_LUAS FROM   ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_555'

	   IF (@VLN_ADJ_LUAS1_2_555) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_555 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_555 = @VLN_DBKB_STANDARD1_2_555 +
	                               @VLN_ADJ_LUAS1_2_555

	   SELECT @VLN_ADJ_BNG1_2_555=((100+SUM(PCT_ADJ_BNG))/100) FROM   ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_555'

	   IF (@VLN_ADJ_BNG1_2_555) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_555 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_555 = (@VLN_STLH_ADJ_LUAS1_2_555 *
	                              @VLN_ADJ_BNG1_2_555)

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_555
	END

	--KD_BNG_LANTAI = 1_2_134
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_134' 
	BEGIN
       SET @VLN_DBKB_STANDARD1_2_134 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_134=PCT_ADJ_LUAS FROM ADJ_LUAS
	   WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_134'

	   IF (@VLN_ADJ_LUAS1_2_134) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_134 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_134 = @VLN_DBKB_STANDARD1_2_134 +
	                               @VLN_ADJ_LUAS1_2_134

	   SELECT @VLN_ADJ_BNG1_2_134=((100+SUM(PCT_ADJ_BNG))/100)FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_134'

	   IF (@VLN_ADJ_BNG1_2_134) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_134 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_134 = (@VLN_STLH_ADJ_LUAS1_2_134 *
	                              @VLN_ADJ_BNG1_2_134)

	   IF (@VLN_STLH_ADJ_BNG1_2_134) = 0 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_2_134 = 0
	   END

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_134
	END

	--KD_BNG_LANTAI = 2_2_216
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='2_2_216' 
	BEGIN
	   SET @VLN_DBKB_STANDARD2_2_216  = @VLN_NILAI_DBKB_STANDARD
	   SET @VLN_DBKB_STANDARD2_2_216A = @VLN_DBKB_STANDARD2_2_216 * 1.38
	   SET @VLN_NILAI_AKHIR           = @VLN_DBKB_STANDARD2_2_216A

	END

    --KD_BNG_LANTAI = 1_2_375
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='1_2_375' 
	BEGIN
	   SET @VLN_DBKB_STANDARD1_2_375 = @VLN_NILAI_DBKB_STANDARD

	   SELECT @VLN_ADJ_LUAS1_2_375=PCT_ADJ_LUAS FROM ADJ_LUAS
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_375'

	   IF (@VLN_ADJ_LUAS1_2_375) = 0 
	   BEGIN
	      SET @VLN_ADJ_LUAS1_2_375 = 0
	   END

       SET @VLN_STLH_ADJ_LUAS1_2_375 = @VLN_DBKB_STANDARD1_2_375 +
	                               @VLN_ADJ_LUAS1_2_375

	   SELECT @VLN_ADJ_BNG1_2_375=((100+SUM(PCT_ADJ_BNG))/100) FROM ADJ_BANGUNAN
       WHERE LTRIM(RTRIM(KD_JPB))        = '01' AND
             LTRIM(RTRIM(KD_BNG_LANTAI)) = '1_2_375'

	   IF (@VLN_ADJ_BNG1_2_375) = 0 
	   BEGIN
	      SET @VLN_ADJ_BNG1_2_375 = 0
	   END

       SET @VLN_STLH_ADJ_BNG1_2_375 = (@VLN_STLH_ADJ_LUAS1_2_375 *
	                              @VLN_ADJ_BNG1_2_375)

	   IF @VLN_STLH_ADJ_BNG1_2_375 IS NULL 
	   BEGIN
	      SET @VLN_STLH_ADJ_BNG1_2_375 = 0
	   END

       SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_375
	END

	--KD_BNG_LANTAI = 2_2_262
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='2_2_262' 
	BEGIN
       BEGIN
		   SELECT @VLN_DBKB_STANDARD2_2_432V=(NILAI_DBKB_STANDARD * 1.38) FROM DBKB_STANDARD
	       WHERE KD_PROPINSI                 = '12'       AND
		         KD_DATI2                    = '12' AND
	             THN_DBKB_STANDARD           = @VLC_THN_DBKB_FINAL AND
				 LTRIM(RTRIM(KD_JPB))        = '02'                  AND
	             LTRIM(RTRIM(KD_BNG_LANTAI)) = '2_2_432'
	   END

  	   SET @VLN_DBKB_STANDARD2_2_262 = @VLN_DBKB_STANDARD2_2_216A+(0.365740741*(@VLN_DBKB_STANDARD2_2_432V - @VLN_DBKB_STANDARD2_2_216A))
  	   --(@VLN_DBKB_STANDARD2_2_216A +(((295-216) / (432-216)) *(@VLN_DBKB_STANDARD2_2_432V - @VLN_DBKB_STANDARD2_2_216A)))

       SET @VLN_NILAI_AKHIR          = @VLN_DBKB_STANDARD2_2_262
	END

	--KD_BNG_LANTAI = 2_2_432
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='2_2_432' 
	BEGIN
       SET @VLN_DBKB_STANDARD2_2_432  = @VLN_NILAI_DBKB_STANDARD
	   SET @VLN_DBKB_STANDARD2_2_432A = @VLN_DBKB_STANDARD2_2_432 * 1.38
	   SET @VLN_NILAI_AKHIR           = @VLN_DBKB_STANDARD2_2_432A
	END

	--KD_BNG_LANTAI = 5_2_262
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='5_2_262' 
	BEGIN
       SET @VLN_DBKB_STANDARD5_2_262 = @VLN_DBKB_STANDARD2_2_262 * 1.20
	   SET @VLN_NILAI_AKHIR          = @VLN_DBKB_STANDARD5_2_262
	END

    --KD_BNG_LANTAI = 2_2_648
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='2_2_648' 
	BEGIN
      SET @VLN_DBKB_STANDARD2_2_648  = @VLN_NILAI_DBKB_STANDARD
	  SET @VLN_DBKB_STANDARD2_2_648A = (@VLN_DBKB_STANDARD2_2_648 * 1.38)
	  SET @VLN_NILAI_AKHIR           = @VLN_DBKB_STANDARD2_2_648A
	END

    --KD_BNG_LANTAI = 2_2_864
	-------------------------
	IF LTRIM(RTRIM(@VLC_KD_BNG_LANTAI))='2_2_864' 
	BEGIN
       SET @VLN_DBKB_STANDARD2_2_864 = @VLN_NILAI_DBKB_STANDARD
	   SET @VLN_DBKB_STANDARD2_2_864A = (@VLN_DBKB_STANDARD2_2_864 * 1.38)
	   SET @VLN_NILAI_AKHIR          =  @VLN_DBKB_STANDARD2_2_864A
	END

	--------------------------------------------------------------
	/*NILAI DBKB STANDARD YANG TETAP PERLU ADJUSTMENT LUAS ATAUPUN
	ADJUSTMENT BANGUNAN*/
	--------------------------------------------------------------
    IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='1_2_045' 
    BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_045
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='1_2_076' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_145
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_045' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_045
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_076' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_076
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_134' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_145
	END
   	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_216' 
   	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_150
	END
  	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_262' 
  	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_295
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_432' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_314
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_648' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_500
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_1_864' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_656
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_2_045' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_1_045
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_2_076' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (@VLN_STLH_ADJ_BNG1_1_145 )
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='2_2_134' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = @VLN_STLH_ADJ_BNG1_2_134
	END

	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_045' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_045,0) * 1.2) 
	   
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_076' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_076,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_134' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_145,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_216' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_150,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_262' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_295,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_432' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_314,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_648' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_500,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_1_864' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_656,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_045' 
	BEGIN
	 SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_045,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_076' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_1_145,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_134' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_STLH_ADJ_BNG1_2_134,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_216' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_DBKB_STANDARD2_2_216A,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_262' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_DBKB_STANDARD2_2_262,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_432' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_DBKB_STANDARD2_2_432A,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_648' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_DBKB_STANDARD2_2_648A,0) * 1.2)
	END
	IF RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))='5_2_864' 
	BEGIN
	   SET @VLN_NILAI_AKHIR = (ROUND(@VLN_DBKB_STANDARD2_2_864A,0) * 1.2)
    END

    BEGIN
		SELECT @VCEK=KD_PROPINSI FROM   DBKB_STANDARD
	    WHERE KD_PROPINSI                 = '12' AND
		      KD_DATI2                    = '12' AND
	          THN_DBKB_STANDARD           = @VLC_THN_DBKB_FINAL      AND
		      KD_JPB                      = @VLC_KD_JPB                 AND
		      RTRIM(LTRIM(TIPE_BNG))      = RTRIM(LTRIM(@VLC_TIPE_BNG)) AND
		 	  RTRIM(LTRIM(KD_BNG_LANTAI)) = RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))
	END

	IF @VCEK <> 'TT' 
	BEGIN
	    UPDATE DBKB_STANDARD
		SET NILAI_DBKB_STANDARD          = ROUND(@VLN_NILAI_AKHIR,0)
	    WHERE KD_PROPINSI                = '12' AND
		      KD_DATI2                   = '12' AND
	          THN_DBKB_STANDARD          = @VLC_THN_DBKB_FINAL      AND
		      KD_JPB                     = @VLC_KD_JPB                 AND
		      RTRIM(LTRIM(TIPE_BNG))     = RTRIM(LTRIM(@VLC_TIPE_BNG)) AND
		 	  RTRIM(LTRIM(KD_BNG_LANTAI))= RTRIM(LTRIM(@VLC_KD_BNG_LANTAI))
	END
 FETCH NEXT FROM C_JPB_TIPEBNG_BNGLANTAI_NILAI2 INTO @VLC_KD_JPB,@VLC_TIPE_BNG,@VLC_KD_BNG_LANTAI,@VLN_NILAI_DBKB_STANDARD
 END
  CLOSE C_JPB_TIPEBNG_BNGLANTAI_NILAI2
  DEALLOCATE C_JPB_TIPEBNG_BNGLANTAI_NILAI2
IF @@ERROR<>0
BEGIN
	ROLLBACK TRAN
END
ELSE
BEGIN
	COMMIT TRAN
END  
END 
